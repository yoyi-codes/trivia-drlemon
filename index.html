<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Trivia Dr. Lemon - SunFest</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="estilos.css">
</head>

<body class="fondo-portada">

    <div class="music-player-container" id="music-container">
        <p class="music-text">Â¿Y si lo hacemos divertido<br>con un poco de mÃºsica?<br>Â¡HacÃ© click acÃ¡!</p>
        <img id="btn-musica-img" src="multimedia/play.png" class="music-icon" onclick="toggleMusica()">
    </div>

    <img src="multimedia/manolata.png" class="decoracion img-manolata" id="decor-left">
    <img src="multimedia/sun.png" class="decoracion img-sun" id="decor-right">

    <div class="container">

        <section id="inicio" class="seccion activa">
            <h1 class="titulo-custom">Â¿CUÃNTO SABÃ‰S<br>DE DR. LEMON?</h1>

            <div class="intro-box">
                <p class="intro-text">
                    <strong>Â¡Somos sponsor del festival del verano!</strong><br><br>
                    AcertÃ¡ <strong>7 preguntas</strong> y ganate entradas para el <strong>SunFest</strong>.<br><br>
                    Â¿Jugamos? ğŸ‹ğŸ’›
                </p>
            </div>

            <button class="btn-accion" onclick="empezarJuego()">JUGAR AHORA</button>
        </section>

        <section id="juego" class="seccion">
            <div class="game-content-wrapper">

                <div class="game-header">
                    <span class="header-txt txt-green">DR. LEMON</span>
                    <span class="header-txt txt-white">X</span>
                    <img src="multimedia/sunfest.png" alt="Sunfest" class="header-logo-img">
                </div>

                <div id="pregunta-texto" class="question-bubble">Cargando...</div>

                <div id="opciones-container" class="options-grid"></div>

                <div id="mensaje-feedback" class="feedback-msg"></div>

            </div>
        </section>

        <section id="final" class="seccion">
            <h1 id="titulo-final"></h1>
            <p id="texto-final" class="intro-text" style="font-size: 22px; margin: 20px 0;"></p>
            <h2 id="puntaje-final"
                style="font-size: 60px; color: #FFE600; margin: 20px 0; text-shadow: 0 0 10px #FF00C8;"></h2>
            <button class="btn-accion" onclick="location.reload()">VOLVER A INTENTAR</button>
        </section>

    </div>

    <div id="animacion-ganadora" class="hidden">
        <div class="hand-container">
            <img src="multimedia/hand-holding.png" class="hand-img">
            <img src="multimedia/lemon.png" class="lemon-drop">
        </div>
    </div>

    <script>
        // --- 1. SONIDOS ---
        const audioCorrecto = new Audio('sonidos/correcto.mp3');
        const audioError = new Audio('sonidos/error.mp3');
        const audioGanaste = new Audio('sonidos/ganaste.mp3');
        const audioIntro = new Audio('sonidos/rock.mp3');

        audioIntro.loop = true;
        audioIntro.volume = 0.5;

        let musicaSonando = false;

        function toggleMusica() {
            const btnImg = document.getElementById('btn-musica-img');

            if (musicaSonando) {
                audioIntro.pause();
                btnImg.src = 'multimedia/play.png';
                btnImg.classList.remove('music-playing');
                musicaSonando = false;
            } else {
                audioIntro.play().catch(e => console.log("InteracciÃ³n requerida"));
                btnImg.src = 'multimedia/stop.png';
                btnImg.classList.add('music-playing');
                musicaSonando = true;
            }
        }

        audioCorrecto.volume = 0.5;
        audioError.volume = 0.4;
        audioGanaste.volume = 0.6;

        // --- 2. BASE DE DATOS ---
        const baseDatos = [{
                pregunta: "Â¿En quÃ© aÃ±o se lanza por primera vez Dr. Lemon en Argentina?",
                /* CAMBIO A PRESENTE */
                tipo: "texto",
                opciones: ["2001", "1998", "2006"],
                correcta: 1,
                msgError: "Parece que te faltÃ³ una ronda de historia con limÃ³n ğŸ˜‰."
            },
            {
                pregunta: "Â¿CuÃ¡l es el primer sabor con el que se presenta Dr. Lemon?",
                /* CAMBIO A PRESENTE */
                tipo: "imagen",
                opciones: ["primersabor", "primersabor1", "primersabor2"],
                correcta: 0,
                msgError: "No pasa nada, todos empezamos mezclando mal alguna vez ğŸ¸."
            },
            {
                pregunta: "Â¿QuÃ© bebida alcohÃ³lica usa Dr. Lemon como base?",
                /* YA ESTABA EN PRESENTE */
                tipo: "texto",
                opciones: ["Vodka", "Ron", "Whisky"],
                correcta: 0,
                msgError: "Te confundiste de tragoâ€¦ Â¡Eso no era Dr. Lemon! ğŸ˜…"
            },
            {
                pregunta: "Â¿QuÃ© caracteriza a Dr. Lemon en comparaciÃ³n con otros tragos listos para tomar?",
                /* YA ESTABA EN PRESENTE */
                tipo: "texto",
                opciones: ["Es 100% natural", "Es gasificada y lista para tomar", "No tiene alcohol"],
                correcta: 1,
                msgError: "Casi casiâ€¦ Â¡AbrÃ­ otra lata y probÃ¡ de nuevo! ğŸ‹ğŸ’¨"
            },
            {
                pregunta: "Â¿CuÃ¡l es la ediciÃ³n limitada?",
                /* YA ESTABA EN PRESENTE */
                tipo: "imagen",
                opciones: ["edicionlimitada1", "edicionlimitada-correcta", "edicionlimitada2"],
                correcta: 1,
                msgError: "Daleee, IntentÃ¡ otra vez ğŸ‹ğŸŠ"
            },
            {
                pregunta: "Â¿CuÃ¡l es el pÃºblico principal de Dr. Lemon?",
                /* YA ESTABA EN PRESENTE */
                tipo: "texto",
                opciones: ["JÃ³venes que disfrutan la mÃºsica, las juntadas y los festivales", "Adultos mayores",
                    "Deportistas profesionales"
                ],
                correcta: 0,
                msgError: "Si no te gusta la mÃºsicaâ€¦ este trago no es para vos ğŸ§."
            },
            {
                pregunta: "Â¿Con quÃ© artista colabora Dr. Lemon?",
                /* CAMBIO A PRESENTE */
                tipo: "texto",
                opciones: ["Tini", "Duki", "Lit Killah"],
                correcta: 1,
                msgError: "Todos son geniales, pero solo es 1 de ellosğŸ˜‰."
            },
            {
                pregunta: "Â¿QuÃ© lema o concepto suele representar a la marca Dr. Lemon?",
                /* YA ESTABA EN PRESENTE */
                tipo: "texto",
                opciones: ["â€œCompartÃ­ lo que te hace bienâ€", "â€œSiempre readyâ€", "â€œUna historia que inspiraâ€"],
                correcta: 1,
                msgError: "QuizÃ¡s lo tuyo es mÃ¡s tÃ© con limÃ³n que Dr. Lemon ğŸ˜œ."
            },
            {
                pregunta: "Â¿CuÃ¡l es el envase actual de Dr. Lemon?",
                /* YA ESTABA EN PRESENTE */
                tipo: "imagen",
                opciones: ["envaseactual1", "envaseactual-correcta", "envaseactual2"],
                correcta: 1,
                msgError: "Si se puede ver ese fanÃ¡tico Â¡clave para aprobar esta ronda! ğŸ‹"
            },
            {
                pregunta: "Â¿De quÃ© otro festival es sponsor Dr. Lemon?",
                /* YA ESTABA EN PRESENTE */
                tipo: "imagen",
                opciones: ["cosquin", "lollapalooza", "oktober"],
                correcta: 1,
                msgError: "Donde sea que haya mÃºsica Dr. Lemon, estÃ¡ presente ğŸ’ƒğŸ•º"
            }
        ];

        let indiceActual = 0;
        let puntaje = 0;
        let juegoTerminado = false;
        let falloEnEstaPregunta = false;

        function empezarJuego() {
            // Ocultar elementos de portada
            document.body.classList.remove('fondo-portada');
            document.body.classList.add('fondo-juego');
            document.getElementById('decor-left').style.display = 'none';
            document.getElementById('decor-right').style.display = 'none';

            // Aseguramos que el botÃ³n de mÃºsica siga visible
            document.getElementById('music-container').style.display = 'flex';

            cambiarPantalla('inicio', 'juego');
            cargarPregunta();
        }

        function cargarPregunta() {
            juegoTerminado = false;
            falloEnEstaPregunta = false;
            const datos = baseDatos[indiceActual];
            document.getElementById('pregunta-texto').innerText = datos.pregunta;
            const feedback = document.getElementById('mensaje-feedback');
            feedback.innerText = ""; // Limpiar
            feedback.style.opacity = "0"; // Ocultar visualmente

            const contenedor = document.getElementById('opciones-container');
            contenedor.innerHTML = '';
            contenedor.className = 'options-grid';

            if (datos.tipo === 'imagen') {
                contenedor.classList.add('imagenes');
            }

            datos.opciones.forEach((opcion, index) => {
                if (datos.tipo === 'imagen') {
                    const img = document.createElement('img');
                    img.src = `multimedia/${opcion}.png`;
                    img.className = 'img-opcion';
                    img.onclick = () => verificarRespuesta(index, img);
                    contenedor.appendChild(img);
                } else {
                    const btn = document.createElement('div');
                    btn.className = 'option';
                    btn.innerText = opcion;
                    btn.onclick = () => verificarRespuesta(index, btn);
                    contenedor.appendChild(btn);
                }
            });
        }

        function verificarRespuesta(indiceElegido, elemento) {
            if (juegoTerminado) return;
            if (elemento.classList.contains('incorrect')) return;

            const datos = baseDatos[indiceActual];
            const feedback = document.getElementById('mensaje-feedback');

            if (indiceElegido === datos.correcta) {
                juegoTerminado = true;
                audioCorrecto.currentTime = 0;
                audioCorrecto.play();
                elemento.classList.add('correct');

                // Feedback: Texto blanco limpio
                feedback.innerText = "Â¡CORRECTO! ğŸ‰";
                feedback.style.color = "#FFF";
                feedback.style.opacity = "1";

                if (!falloEnEstaPregunta) {
                    puntaje++;
                }

                setTimeout(() => {
                    indiceActual++;
                    if (indiceActual < baseDatos.length) {
                        cargarPregunta();
                    } else {
                        terminarJuego();
                    }
                }, 2000);

            } else {
                falloEnEstaPregunta = true;
                audioError.currentTime = 0;
                audioError.play();
                elemento.classList.add('incorrect');
                elemento.style.cursor = "not-allowed";

                feedback.innerText = datos.msgError;
                feedback.style.color = "#FFF";
                feedback.style.opacity = "1";
            }
        }

        function terminarJuego() {
            // APAGAR MÃšSICA Y OCULTAR BOTÃ“N
            document.getElementById('music-container').style.display = 'none';
            audioIntro.pause();

            document.getElementById('juego').classList.remove('activa');
            const scoreDisplay = document.getElementById('puntaje-final');
            scoreDisplay.innerText = puntaje + "/10";

            if (puntaje >= 7) {
                const animOverlay = document.getElementById('animacion-ganadora');
                animOverlay.classList.remove('hidden');
                audioGanaste.play();

                setTimeout(() => {
                    animOverlay.style.transition = "opacity 1s";
                    animOverlay.style.opacity = "0";
                    setTimeout(() => {
                        animOverlay.classList.add('hidden');
                        mostrarPantallaFinal(true);
                    }, 1000);
                }, 3500);

            } else {
                mostrarPantallaFinal(false);
            }
        }

        function mostrarPantallaFinal(gano) {
            document.getElementById('final').classList.add('activa');
            const titulo = document.getElementById('titulo-final');
            const texto = document.getElementById('texto-final');

            if (gano) {
                titulo.innerText = "Â¡FELICIDADES!";
                texto.innerHTML =
                    "Â¡Demostraste que tenÃ©s la vibra!<br><strong>TE GANASTE UN PAR DE ENTRADAS PARA EL SUNSET FEST ğŸŸï¸ğŸŸï¸</strong><br>Â¡A brindar! ğŸ‹ğŸ’›";
            } else {
                titulo.innerText = "Â¡CASI!";
                titulo.style.color = "#FF3434";
                texto.innerHTML =
                    "NecesitÃ¡s al menos <strong>7 respuestas correctas</strong> (sin fallar al primer intento) para ganar las entradas.<br>Â¡No te rindas, intentÃ¡ de nuevo!";
            }
        }

        function cambiarPantalla(idOcultar, idMostrar) {
            document.getElementById(idOcultar).classList.remove('activa');
            document.getElementById(idMostrar).classList.add('activa');
        }
    </script>
</body>

</html>